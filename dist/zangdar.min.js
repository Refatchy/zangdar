!function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){t.exports=r(1)},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n(this,"$form",null),n(this,"_$prevButton",null),n(this,"_steps",[]),n(this,"_currentIndex",null),n(this,"_params",{step_selector:"[data-step]",prev_step_selector:"[data-prev]",next_step_selector:"[data-next]",submit_selector:'[type="submit"]',active_step_index:0,classes:{form:"zandgar__wizard",prev_button:"zandgar__prev",next_button:"zandgar__next",step:"zandgar__step",step_active:"zandgar__step__active"},onSubmit:function(t){return t.preventDefault(),console.log(t),!1},onValidation:function(t,e,r){console.log("On step validation",t,e)},onStepChange:function(t,e,r){console.log("On step change",t,e)},customValidation:null}),this.$form=e instanceof HTMLFormElement?e:document.querySelector(e),this.$form.constructor!==HTMLFormElement)throw new Error("[Err] Zangdar.constructor - the container must be a valid HTML form element");this._params=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},s=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),s.forEach(function(e){n(t,e,r[e])})}return t}({},this._params,r),this._init()}var e,s,a;return e=t,(s=[{key:"goTo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._currentIndex;return this._steps[t]||null}},{key:"goToStep",value:function(t){throw this._steps.findIndex(function(e){return e.label===t})>=0&&this._revealStep(),new Error('[Err] Zangdar.goToStep - step "'.concat(t,'" not found'))}},{key:"createFromTemplate",value:function(t){var e=this,r=0;for(var n in t)++r,t.hasOwnProperty(n)&&function(){var s=t[n],a=e._buildSection(n);if(s.forEach(function(t){var r=e.$form.querySelector(t);if(null!==r){var n=r.cloneNode(!0);a.appendChild(n),r.parentNode.removeChild(r)}}),r<Object.keys(t).length&&null===a.querySelector(e._params.next_step_selector)){var o=document.createElement("button");o.setAttribute(e._params.next_step_selector.replace(/\[|\]/gi,""),""),o.innerText="Next",a.appendChild(o)}if(r===Object.keys(t).length){var i=e.$form.querySelector(e._params.submit_selector);if(null!==i){var u=i.cloneNode(!0);a.appendChild(u),i.parentNode.removeChild(i)}}e.$form.appendChild(a)}();this._init()}},{key:"getCurrentStep",value:function(){return this.goTo()}},{key:"_init",value:function(){this.$form.querySelectorAll(this._params.step_selector).length&&(this._buildForm(),this._buildPrevButton(),this._buildSteps())}},{key:"_buildForm",value:function(){var t=this,e=this._params.onSubmit;this.$form.classList.add(this._params.classes.form),this.$form.addEventListener("submit",function(r){t._validateCurrentStep()&&(e&&e.constructor===Function?e(r):r.target.submit())})}},{key:"_buildPrevButton",value:function(){var t=this;this._$prevButton=this.$form.querySelector(this._params.prev_step_selector),null===this._$prevButton&&(this._$prevButton=document.createElement("button"),this._$prevButton.setAttribute("data-prev",""),this._$prevButton.innerText="Prev.",this.$form.insertBefore(this._$prevButton,this.$form.firstChild)),this._$prevButton.classList.add(this._params.classes.prev_button),this._$prevButton.addEventListener("click",function(e){e.preventDefault(),t._prevStep()})}},{key:"_buildSteps",value:function(){var t=this,e=Array.from(this.$form.querySelectorAll(this._params.step_selector));if(!e.length)throw new Error('[Err] Zangdar._buildSteps - you must have at least one step (a HTML element with "'.concat(this._params.step_selector,'" attribute)'));e.reduce(function(r,n,s){var a=n.dataset.step;if(n.classList.add(t._params.classes.step),s===t._params.active_step_index&&(n.classList.add(t._params.classes.step_active),t._currentIndex=s),s<e.length-1&&!n.querySelector(t._params.next_step_selector))throw new Error('[Err] Zangdar._buildSteps - step "'.concat(a,'" - you must have a next button (with "').concat(t._params.next_step_selector,'" attribute") on this step'));if(s<e.length-1&&n.querySelector(t._params.next_step_selector)){var o=n.querySelector(t._params.next_step_selector);o.classList.add(t._params.classes.next_button),o.addEventListener("click",function(e){e.preventDefault(),t._validateCurrentStep()&&t._nextStep()})}return r.push({el:n,label:a,active:!1,errors:{}}),r},this._steps),this._currentIndex=this._params.active_step_index,this._revealStep()}},{key:"_buildSection",value:function(t){var e=document.createElement("section");return e.setAttribute(this._params.step_selector.replace(/\[|\]/gi,""),t),e}},{key:"_revealStep",value:function(){var t=this;this._steps.forEach(function(e,r){e.active=t._currentIndex===r,e.active?e.el.classList.add(t._params.classes.step_active):e.el.classList.remove(t._params.classes.step_active)}),this._$prevButton.style.display=0===this._currentIndex?"none":""}},{key:"_prevStep",value:function(){var t=this.getCurrentStep();this._currentIndex=this._currentIndex-1<0?0:this._currentIndex-1,this._params.onStepChange(this.getCurrentStep(),t,this.$form),this._revealStep()}},{key:"_nextStep",value:function(){var t=this.getCurrentStep();this._currentIndex=this._currentIndex<this._steps.length-1?this._currentIndex+1:this._steps.length,this._params.onStepChange(this.getCurrentStep(),t,this.$form),this._revealStep()}},{key:"_validateCurrentStep",value:function(){var t=this._steps[this._currentIndex],e=this._formElements(t.el);if(this._params.customValidation&&this._params.customValidation.constructor===Function)return this.$form.setAttribute("novalidate",""),this._params.customValidation(t,e,this.$form);this.$form.removeAttribute("novalidate"),t.errors={};var r=!0;return Array.from(e).reverse().forEach(function(e){e.checkValidity()||(r=!1,t.errors[e.name]||(t.errors[e.name]=[]),t.errors[e.name].push(e.validationMessage),e.reportValidity())}),this._params.onValidation(t,e,this.$form),r}},{key:"_formElements",value:function(t){return t.querySelectorAll("            ".concat(this._params.step_selector,' input:not([type="hidden"]):not([disabled]),            ').concat(this._params.step_selector," select:not([disabled]),            ").concat(this._params.step_selector," textarea:not([disabled])        "))}}])&&r(e.prototype,s),a&&r(e,a),t}();void 0!==window?(!window.hasOwnProperty("Zangdar")&&(window.Zangdar=s),HTMLFormElement.prototype.zangdar||(HTMLFormElement.prototype.zangdar=function(t){return new s(this,t)})):t.exports=s}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiWmFuZ2RhciIsImVsZW1lbnQiLCJvcHRpb25zIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsIl9kZWZpbmVQcm9wZXJ0eSIsInN0ZXBfc2VsZWN0b3IiLCJwcmV2X3N0ZXBfc2VsZWN0b3IiLCJuZXh0X3N0ZXBfc2VsZWN0b3IiLCJzdWJtaXRfc2VsZWN0b3IiLCJhY3RpdmVfc3RlcF9pbmRleCIsImNsYXNzZXMiLCJmb3JtIiwicHJldl9idXR0b24iLCJuZXh0X2J1dHRvbiIsInN0ZXAiLCJzdGVwX2FjdGl2ZSIsIm9uU3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiY29uc29sZSIsImxvZyIsIm9uVmFsaWRhdGlvbiIsImZpZWxkcyIsIm9uU3RlcENoYW5nZSIsIm9sZFN0ZXAiLCJjdXN0b21WYWxpZGF0aW9uIiwiJGZvcm0iLCJIVE1MRm9ybUVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb25zdHJ1Y3RvciIsIkVycm9yIiwiX3BhcmFtcyIsIl9vYmplY3RTcHJlYWQiLCJfaW5pdCIsImluZGV4IiwiX2N1cnJlbnRJbmRleCIsIl9zdGVwcyIsImxhYmVsIiwiZmluZEluZGV4IiwiX3JldmVhbFN0ZXAiLCJjb25jYXQiLCJ0ZW1wbGF0ZSIsIl90aGlzIiwiJHNlY3Rpb24iLCJfYnVpbGRTZWN0aW9uIiwiZm9yRWFjaCIsImZpZWxkIiwiZWwiLCJuZXdFbG0iLCJjbG9uZU5vZGUiLCJhcHBlbmRDaGlsZCIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImtleXMiLCIkbmV4dEJ1dHRvbiIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJyZXBsYWNlIiwiaW5uZXJUZXh0IiwiJHN1Ym1pdEJ1dHRvbiIsIm5ld0J0biIsImdvVG8iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2J1aWxkRm9ybSIsIl9idWlsZFByZXZCdXR0b24iLCJfYnVpbGRTdGVwcyIsIl90aGlzMiIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfdmFsaWRhdGVDdXJyZW50U3RlcCIsIkZ1bmN0aW9uIiwidGFyZ2V0Iiwic3VibWl0IiwiX3RoaXMzIiwiXyRwcmV2QnV0dG9uIiwiaW5zZXJ0QmVmb3JlIiwiZmlyc3RDaGlsZCIsIl9wcmV2U3RlcCIsIl90aGlzNCIsInN0ZXBzIiwiQXJyYXkiLCJmcm9tIiwicmVkdWNlIiwiYWNjIiwiaXRlbSIsImRhdGFzZXQiLCJfbmV4dFN0ZXAiLCJwdXNoIiwiYWN0aXZlIiwiZXJyb3JzIiwiX3RoaXM1IiwicmVtb3ZlIiwic3R5bGUiLCJkaXNwbGF5IiwiZ2V0Q3VycmVudFN0ZXAiLCJjdXJyZW50U3RlcCIsIl9mb3JtRWxlbWVudHMiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpc1ZhbGlkIiwicmV2ZXJzZSIsImNoZWNrVmFsaWRpdHkiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInJlcG9ydFZhbGlkaXR5Iiwid2luZG93IiwiemFuZ2RhciJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFB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LEVBQVlOLE9BQVMsR0FDckIsSUFBSVMsR0FBVSxFQWNkLE9BYkFsQixNQUFNQyxLQUFLN0QsR0FDTitFLFVBQ0F2RCxRQUFRLFNBQUFFLEdBQ0FBLEVBQUdzRCxrQkFDSkYsR0FBVSxFQUNMSCxFQUFZTixPQUFPM0MsRUFBRzdFLFFBQ3ZCOEgsRUFBWU4sT0FBTzNDLEVBQUc3RSxNQUFRLElBRWxDOEgsRUFBWU4sT0FBTzNDLEVBQUc3RSxNQUFNc0gsS0FBS3pDLEVBQUd1RCxtQkFDcEN2RCxFQUFHd0Qsb0JBR2ZyRyxLQUFLNkIsUUFBUVgsYUFBYTRFLEVBQWEzRSxFQUFRbkIsS0FBS3VCLE9BQzdDMEUsd0NBR0dwRCxHQUNWLE9BQU9BLEVBQUdlLGlCQUFILGVBQUF0QixPQUNEdEMsS0FBSzZCLFFBQVEzQixjQURaLDREQUFBb0MsT0FFRHRDLEtBQUs2QixRQUFRM0IsY0FGWix3Q0FBQW9DLE9BR0R0QyxLQUFLNkIsUUFBUTNCLGNBSFosZ0ZBUUFKLElBQVh3RyxTQUNDQSxPQUFPaEgsZUFBZSxhQUFlZ0gsT0FBTzdHLFFBQVVBLEdBQ25EK0IsZ0JBQWdCbkMsVUFBVWtILFVBQzFCL0UsZ0JBQWdCbkMsVUFBVWtILFFBQVUsU0FBVTVHLEdBQzFDLE9BQU8sSUFBSUYsRUFBUU8sS0FBTUwsTUFJakNuQyxFQUFPRCxRQUFVa0MiLCJmaWxlIjoiemFuZ2Rhci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJjbGFzcyBaYW5nZGFyIHtcblxuICAgIC8qKlxuICAgICAqIEB0eXBlIHtIVE1MRm9ybUVsZW1lbnR9XG4gICAgICovXG4gICAgJGZvcm0gPSBudWxsXG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudHxudWxsfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgXyRwcmV2QnV0dG9uID0gbnVsbFxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAdHlwZSB7QXJyYXl9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc3RlcHMgPSBbXVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAdHlwZSB7TnVtYmVyfG51bGx9XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfY3VycmVudEluZGV4ID0gbnVsbFxuXG5cbiAgICAvKipcbiAgICAgKiBAdHlwZSB7T2JqZWN0fVxuICAgICAqIEB0eXBlIHt7c3RlcF9zZWxlY3Rvcjogc3RyaW5nLCBwcmV2X3N0ZXBfc2VsZWN0b3I6IHN0cmluZywgb25TdGVwQ2hhbmdlKE9iamVjdCwgT2JqZWN0KTogdm9pZCwgYWN0aXZlX3N0ZXBfaW5kZXg6IG51bWJlciwgb25TdWJtaXQoRXZlbnQpOiBib29sZWFuLCBjbGFzc2VzOiB7cHJldl9idXR0b246IHN0cmluZywgbmV4dF9idXR0b246IHN0cmluZywgZm9ybTogc3RyaW5nLCBzdGVwOiBzdHJpbmcsIHN0ZXBfYWN0aXZlOiBzdHJpbmd9LCBuZXh0X3N0ZXBfc2VsZWN0b3I6IHN0cmluZywgY3VzdG9tVmFsaWRhdGlvbjogKGZ1bmN0aW9uKE9iamVjdCwgTm9kZUxpc3QpOiBib29sZWFuKSwgb25WYWxpZGF0aW9uKE9iamVjdCwgTm9kZUxpc3QpOiB2b2lkfX1cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9wYXJhbXMgPSB7XG4gICAgICAgIHN0ZXBfc2VsZWN0b3I6ICdbZGF0YS1zdGVwXScsXG4gICAgICAgIHByZXZfc3RlcF9zZWxlY3RvcjogJ1tkYXRhLXByZXZdJyxcbiAgICAgICAgbmV4dF9zdGVwX3NlbGVjdG9yOiAnW2RhdGEtbmV4dF0nLFxuICAgICAgICBzdWJtaXRfc2VsZWN0b3I6ICdbdHlwZT1cInN1Ym1pdFwiXScsXG4gICAgICAgIGFjdGl2ZV9zdGVwX2luZGV4OiAwLFxuICAgICAgICBjbGFzc2VzOiB7XG4gICAgICAgICAgICBmb3JtOiAnemFuZGdhcl9fd2l6YXJkJyxcbiAgICAgICAgICAgIHByZXZfYnV0dG9uOiAnemFuZGdhcl9fcHJldicsXG4gICAgICAgICAgICBuZXh0X2J1dHRvbjogJ3phbmRnYXJfX25leHQnLFxuICAgICAgICAgICAgc3RlcDogJ3phbmRnYXJfX3N0ZXAnLFxuICAgICAgICAgICAgc3RlcF9hY3RpdmU6ICd6YW5kZ2FyX19zdGVwX19hY3RpdmUnLFxuICAgICAgICB9LFxuICAgICAgICBvblN1Ym1pdChlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgb25WYWxpZGF0aW9uKHN0ZXAsIGZpZWxkcywgZm9ybSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ09uIHN0ZXAgdmFsaWRhdGlvbicsIHN0ZXAsIGZpZWxkcylcbiAgICAgICAgfSxcbiAgICAgICAgb25TdGVwQ2hhbmdlKHN0ZXAsIG9sZFN0ZXAsIGZvcm0pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdPbiBzdGVwIGNoYW5nZScsIHN0ZXAsIG9sZFN0ZXApXG4gICAgICAgIH0sXG4gICAgICAgIC8qY3VzdG9tVmFsaWRhdGlvbihzdGVwLCBmaWVsZHMsIGZvcm0pIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdPbiBjdXN0b20gdmFsaWRhdGlvbicsIHN0ZXAsIGZpZWxkcylcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH0sKi9cbiAgICAgICAgY3VzdG9tVmFsaWRhdGlvbjogbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7SFRNTEZvcm1FbGVtZW50fFN0cmluZ30gZWxlbWVudFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZWxlbWVudCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgICAgIHRoaXMuJGZvcm0gPSBlbGVtZW50IGluc3RhbmNlb2YgSFRNTEZvcm1FbGVtZW50XG4gICAgICAgICAgICA/IGVsZW1lbnRcbiAgICAgICAgICAgIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KVxuXG4gICAgICAgIGlmICh0aGlzLiRmb3JtLmNvbnN0cnVjdG9yICE9PSBIVE1MRm9ybUVsZW1lbnQpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFtFcnJdIFphbmdkYXIuY29uc3RydWN0b3IgLSB0aGUgY29udGFpbmVyIG11c3QgYmUgYSB2YWxpZCBIVE1MIGZvcm0gZWxlbWVudGApXG5cbiAgICAgICAgdGhpcy5fcGFyYW1zID0ge1xuICAgICAgICAgICAgLi4udGhpcy5fcGFyYW1zLFxuICAgICAgICAgICAgLi4ub3B0aW9uc1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5faW5pdCgpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHN0ZXAgYnkgaGlzIGluZGV4XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXhcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fG51bGx9XG4gICAgICovXG4gICAgZ29UbyhpbmRleCA9IHRoaXMuX2N1cnJlbnRJbmRleCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3RlcHNbaW5kZXhdIHx8IG51bGxcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHbyB0byBhIHN0ZXAgYnkgbGFiZWwgKGRhdGEtc3RlcCBhdHRyaWJ1dGUgdmFsdWUpXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbGFiZWxcbiAgICAgKi9cbiAgICBnb1RvU3RlcChsYWJlbCkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuX3N0ZXBzLmZpbmRJbmRleChzdGVwID0+IHN0ZXAubGFiZWwgPT09IGxhYmVsKVxuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5fcmV2ZWFsU3RlcCgpXG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBbRXJyXSBaYW5nZGFyLmdvVG9TdGVwIC0gc3RlcCBcIiR7bGFiZWx9XCIgbm90IGZvdW5kYClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSB3aXphcmQgZnJvbSBhbiBleGlzdGluZyBmb3JtIHdpdGggYSB0ZW1wbGF0ZSB3aGljaCBpcyBkZXNjcmliZXMgaXRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0ZW1wbGF0ZSB0aGUgd2l6YXJkIHRlbXBsYXRlXG4gICAgICovXG4gICAgY3JlYXRlRnJvbVRlbXBsYXRlKHRlbXBsYXRlKSB7XG4gICAgICAgIGxldCBpID0gMFxuICAgICAgICBmb3IgKGxldCBsYWJlbCBpbiB0ZW1wbGF0ZSkge1xuICAgICAgICAgICAgKytpXG4gICAgICAgICAgICBpZiAodGVtcGxhdGUuaGFzT3duUHJvcGVydHkobGFiZWwpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRzID0gdGVtcGxhdGVbbGFiZWxdXG4gICAgICAgICAgICAgICAgY29uc3QgJHNlY3Rpb24gPSB0aGlzLl9idWlsZFNlY3Rpb24obGFiZWwpXG4gICAgICAgICAgICAgICAgZmllbGRzLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbCA9IHRoaXMuJGZvcm0ucXVlcnlTZWxlY3RvcihmaWVsZClcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdFbG0gPSBlbC5jbG9uZU5vZGUodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICRzZWN0aW9uLmFwcGVuZENoaWxkKG5ld0VsbSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGlmIChpIDwgT2JqZWN0LmtleXModGVtcGxhdGUpLmxlbmd0aCAmJiAkc2VjdGlvbi5xdWVyeVNlbGVjdG9yKHRoaXMuX3BhcmFtcy5uZXh0X3N0ZXBfc2VsZWN0b3IpID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0ICRuZXh0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICAgICAgICAgICAgICAgICAgJG5leHRCdXR0b24uc2V0QXR0cmlidXRlKHRoaXMuX3BhcmFtcy5uZXh0X3N0ZXBfc2VsZWN0b3IucmVwbGFjZSgvXFxbfFxcXS9pZywgJycpLCAnJylcbiAgICAgICAgICAgICAgICAgICAgJG5leHRCdXR0b24uaW5uZXJUZXh0ID0gJ05leHQnXG4gICAgICAgICAgICAgICAgICAgICRzZWN0aW9uLmFwcGVuZENoaWxkKCRuZXh0QnV0dG9uKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gT2JqZWN0LmtleXModGVtcGxhdGUpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCAkc3VibWl0QnV0dG9uID0gdGhpcy4kZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3BhcmFtcy5zdWJtaXRfc2VsZWN0b3IpXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc3VibWl0QnV0dG9uICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdCdG4gPSAkc3VibWl0QnV0dG9uLmNsb25lTm9kZSh0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNlY3Rpb24uYXBwZW5kQ2hpbGQobmV3QnRuKVxuICAgICAgICAgICAgICAgICAgICAgICAgJHN1Ym1pdEJ1dHRvbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCRzdWJtaXRCdXR0b24pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy4kZm9ybS5hcHBlbmRDaGlsZCgkc2VjdGlvbilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pbml0KClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgc3RlcFxuICAgICAqXG4gICAgICogQHJldHVybnMge09iamVjdHxudWxsfSB0aGUgY3VycmVudCBzdGVwIGlmIGV4aXN0cywgbnVsbCBvdGhlcndpc2VcbiAgICAgKi9cbiAgICBnZXRDdXJyZW50U3RlcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ29UbygpXG4gICAgfVxuXG4gICAgX2luaXQoKSB7XG4gICAgICAgIGlmICh0aGlzLiRmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fcGFyYW1zLnN0ZXBfc2VsZWN0b3IpLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5fYnVpbGRGb3JtKClcbiAgICAgICAgICAgIHRoaXMuX2J1aWxkUHJldkJ1dHRvbigpXG4gICAgICAgICAgICB0aGlzLl9idWlsZFN0ZXBzKClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9idWlsZEZvcm0oKSB7XG4gICAgICAgIGNvbnN0IG9uU3VibWl0ID0gdGhpcy5fcGFyYW1zLm9uU3VibWl0XG4gICAgICAgIHRoaXMuJGZvcm0uY2xhc3NMaXN0LmFkZCh0aGlzLl9wYXJhbXMuY2xhc3Nlcy5mb3JtKVxuICAgICAgICB0aGlzLiRmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGUgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3ZhbGlkYXRlQ3VycmVudFN0ZXAoKSkge1xuICAgICAgICAgICAgICAgIGlmIChvblN1Ym1pdCAmJiBvblN1Ym1pdC5jb25zdHJ1Y3RvciA9PT0gRnVuY3Rpb24pXG4gICAgICAgICAgICAgICAgICAgIG9uU3VibWl0KGUpXG4gICAgICAgICAgICAgICAgZWxzZSBlLnRhcmdldC5zdWJtaXQoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2J1aWxkUHJldkJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fJHByZXZCdXR0b24gPSB0aGlzLiRmb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fcGFyYW1zLnByZXZfc3RlcF9zZWxlY3RvcilcblxuICAgICAgICBpZiAodGhpcy5fJHByZXZCdXR0b24gPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuXyRwcmV2QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICAgICAgICAgIHRoaXMuXyRwcmV2QnV0dG9uLnNldEF0dHJpYnV0ZSgnZGF0YS1wcmV2JywgJycpXG4gICAgICAgICAgICB0aGlzLl8kcHJldkJ1dHRvbi5pbm5lclRleHQgPSAnUHJldi4nXG4gICAgICAgICAgICB0aGlzLiRmb3JtLmluc2VydEJlZm9yZSh0aGlzLl8kcHJldkJ1dHRvbiwgdGhpcy4kZm9ybS5maXJzdENoaWxkKVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fJHByZXZCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9wYXJhbXMuY2xhc3Nlcy5wcmV2X2J1dHRvbilcbiAgICAgICAgdGhpcy5fJHByZXZCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgdGhpcy5fcHJldlN0ZXAoKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2J1aWxkU3RlcHMoKSB7XG4gICAgICAgIGxldCBzdGVwcyA9IEFycmF5LmZyb20odGhpcy4kZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3BhcmFtcy5zdGVwX3NlbGVjdG9yKSlcblxuICAgICAgICBpZiAoIXN0ZXBzLmxlbmd0aClcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW0Vycl0gWmFuZ2Rhci5fYnVpbGRTdGVwcyAtIHlvdSBtdXN0IGhhdmUgYXQgbGVhc3Qgb25lIHN0ZXAgKGEgSFRNTCBlbGVtZW50IHdpdGggXCIke3RoaXMuX3BhcmFtcy5zdGVwX3NlbGVjdG9yfVwiIGF0dHJpYnV0ZSlgKVxuXG4gICAgICAgIHN0ZXBzLnJlZHVjZSgoYWNjLCBpdGVtLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RlcCA9IGl0ZW0uZGF0YXNldC5zdGVwXG4gICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fcGFyYW1zLmNsYXNzZXMuc3RlcClcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gdGhpcy5fcGFyYW1zLmFjdGl2ZV9zdGVwX2luZGV4KSB7XG4gICAgICAgICAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKHRoaXMuX3BhcmFtcy5jbGFzc2VzLnN0ZXBfYWN0aXZlKVxuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRJbmRleCA9IGluZGV4XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpbmRleCA8IHN0ZXBzLmxlbmd0aCAtIDEgJiYgIWl0ZW0ucXVlcnlTZWxlY3Rvcih0aGlzLl9wYXJhbXMubmV4dF9zdGVwX3NlbGVjdG9yKSlcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFtFcnJdIFphbmdkYXIuX2J1aWxkU3RlcHMgLSBzdGVwIFwiJHtzdGVwfVwiIC0geW91IG11c3QgaGF2ZSBhIG5leHQgYnV0dG9uICh3aXRoIFwiJHt0aGlzLl9wYXJhbXMubmV4dF9zdGVwX3NlbGVjdG9yfVwiIGF0dHJpYnV0ZVwiKSBvbiB0aGlzIHN0ZXBgKVxuXG4gICAgICAgICAgICBpZiAoaW5kZXggPCBzdGVwcy5sZW5ndGggLSAxICYmIGl0ZW0ucXVlcnlTZWxlY3Rvcih0aGlzLl9wYXJhbXMubmV4dF9zdGVwX3NlbGVjdG9yKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0ICRuZXh0QnV0dG9uID0gaXRlbS5xdWVyeVNlbGVjdG9yKHRoaXMuX3BhcmFtcy5uZXh0X3N0ZXBfc2VsZWN0b3IpXG5cbiAgICAgICAgICAgICAgICAkbmV4dEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX3BhcmFtcy5jbGFzc2VzLm5leHRfYnV0dG9uKVxuICAgICAgICAgICAgICAgICRuZXh0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fdmFsaWRhdGVDdXJyZW50U3RlcCgpKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbmV4dFN0ZXAoKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGFjYy5wdXNoKHtcbiAgICAgICAgICAgICAgICBlbDogaXRlbSxcbiAgICAgICAgICAgICAgICBsYWJlbDogc3RlcCxcbiAgICAgICAgICAgICAgICBhY3RpdmU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGVycm9yczoge31cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICByZXR1cm4gYWNjXG4gICAgICAgIH0sIHRoaXMuX3N0ZXBzKVxuXG4gICAgICAgIHRoaXMuX2N1cnJlbnRJbmRleCA9IHRoaXMuX3BhcmFtcy5hY3RpdmVfc3RlcF9pbmRleFxuICAgICAgICB0aGlzLl9yZXZlYWxTdGVwKClcbiAgICB9XG5cbiAgICBfYnVpbGRTZWN0aW9uKGxhYmVsKSB7XG4gICAgICAgIGNvbnN0ICRzZWN0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VjdGlvbicpXG4gICAgICAgICRzZWN0aW9uLnNldEF0dHJpYnV0ZSh0aGlzLl9wYXJhbXMuc3RlcF9zZWxlY3Rvci5yZXBsYWNlKC9cXFt8XFxdL2lnLCAnJyksIGxhYmVsKVxuICAgICAgICByZXR1cm4gJHNlY3Rpb25cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9yZXZlYWxTdGVwKCkge1xuICAgICAgICB0aGlzLl9zdGVwcy5mb3JFYWNoKChzdGVwLCBpKSA9PiB7XG4gICAgICAgICAgICBzdGVwLmFjdGl2ZSA9IHRoaXMuX2N1cnJlbnRJbmRleCA9PT0gaVxuICAgICAgICAgICAgaWYgKHN0ZXAuYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgc3RlcC5lbC5jbGFzc0xpc3QuYWRkKHRoaXMuX3BhcmFtcy5jbGFzc2VzLnN0ZXBfYWN0aXZlKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdGVwLmVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fcGFyYW1zLmNsYXNzZXMuc3RlcF9hY3RpdmUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMuXyRwcmV2QnV0dG9uLnN0eWxlLmRpc3BsYXkgPSB0aGlzLl9jdXJyZW50SW5kZXggPT09IDAgPyAnbm9uZScgOiAnJ1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3ByZXZTdGVwKCkge1xuICAgICAgICBjb25zdCBvbGRTdGVwID0gdGhpcy5nZXRDdXJyZW50U3RlcCgpXG4gICAgICAgIHRoaXMuX2N1cnJlbnRJbmRleCA9IHRoaXMuX2N1cnJlbnRJbmRleCAtIDEgPCAwID8gMCA6IHRoaXMuX2N1cnJlbnRJbmRleCAtIDFcbiAgICAgICAgdGhpcy5fcGFyYW1zLm9uU3RlcENoYW5nZSh0aGlzLmdldEN1cnJlbnRTdGVwKCksIG9sZFN0ZXAsIHRoaXMuJGZvcm0pXG4gICAgICAgIHRoaXMuX3JldmVhbFN0ZXAoKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX25leHRTdGVwKCkge1xuICAgICAgICBjb25zdCBvbGRTdGVwID0gdGhpcy5nZXRDdXJyZW50U3RlcCgpXG4gICAgICAgIHRoaXMuX2N1cnJlbnRJbmRleCA9IHRoaXMuX2N1cnJlbnRJbmRleCA8IHRoaXMuX3N0ZXBzLmxlbmd0aCAtIDFcbiAgICAgICAgICAgID8gdGhpcy5fY3VycmVudEluZGV4ICsgMVxuICAgICAgICAgICAgOiB0aGlzLl9zdGVwcy5sZW5ndGhcbiAgICAgICAgdGhpcy5fcGFyYW1zLm9uU3RlcENoYW5nZSh0aGlzLmdldEN1cnJlbnRTdGVwKCksIG9sZFN0ZXAsIHRoaXMuJGZvcm0pXG4gICAgICAgIHRoaXMuX3JldmVhbFN0ZXAoKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3ZhbGlkYXRlQ3VycmVudFN0ZXAoKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRTdGVwID0gdGhpcy5fc3RlcHNbdGhpcy5fY3VycmVudEluZGV4XVxuICAgICAgICBjb25zdCBmaWVsZHMgPSB0aGlzLl9mb3JtRWxlbWVudHMoY3VycmVudFN0ZXAuZWwpXG4gICAgICAgIGlmICh0aGlzLl9wYXJhbXMuY3VzdG9tVmFsaWRhdGlvbiAmJiB0aGlzLl9wYXJhbXMuY3VzdG9tVmFsaWRhdGlvbi5jb25zdHJ1Y3RvciA9PT0gRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMuJGZvcm0uc2V0QXR0cmlidXRlKCdub3ZhbGlkYXRlJywgJycpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcGFyYW1zLmN1c3RvbVZhbGlkYXRpb24oY3VycmVudFN0ZXAsIGZpZWxkcywgdGhpcy4kZm9ybSlcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiRmb3JtLnJlbW92ZUF0dHJpYnV0ZSgnbm92YWxpZGF0ZScpXG4gICAgICAgIGN1cnJlbnRTdGVwLmVycm9ycyA9IHt9XG4gICAgICAgIGxldCBpc1ZhbGlkID0gdHJ1ZVxuICAgICAgICBBcnJheS5mcm9tKGZpZWxkcylcbiAgICAgICAgICAgIC5yZXZlcnNlKClcbiAgICAgICAgICAgIC5mb3JFYWNoKGVsID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWVsLmNoZWNrVmFsaWRpdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50U3RlcC5lcnJvcnNbZWwubmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGVwLmVycm9yc1tlbC5uYW1lXSA9IFtdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0ZXAuZXJyb3JzW2VsLm5hbWVdLnB1c2goZWwudmFsaWRhdGlvbk1lc3NhZ2UpXG4gICAgICAgICAgICAgICAgICAgIGVsLnJlcG9ydFZhbGlkaXR5KClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB0aGlzLl9wYXJhbXMub25WYWxpZGF0aW9uKGN1cnJlbnRTdGVwLCBmaWVsZHMsIHRoaXMuJGZvcm0pXG4gICAgICAgIHJldHVybiBpc1ZhbGlkXG4gICAgfVxuXG4gICAgX2Zvcm1FbGVtZW50cyhlbCkge1xuICAgICAgICByZXR1cm4gZWwucXVlcnlTZWxlY3RvckFsbChgXFxcbiAgICAgICAgICAgICR7dGhpcy5fcGFyYW1zLnN0ZXBfc2VsZWN0b3J9IGlucHV0Om5vdChbdHlwZT1cImhpZGRlblwiXSk6bm90KFtkaXNhYmxlZF0pLFxcXG4gICAgICAgICAgICAke3RoaXMuX3BhcmFtcy5zdGVwX3NlbGVjdG9yfSBzZWxlY3Q6bm90KFtkaXNhYmxlZF0pLFxcXG4gICAgICAgICAgICAke3RoaXMuX3BhcmFtcy5zdGVwX3NlbGVjdG9yfSB0ZXh0YXJlYTpub3QoW2Rpc2FibGVkXSlcXFxuICAgICAgICBgKVxuICAgIH1cbn1cblxuaWYgKHdpbmRvdyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgIXdpbmRvdy5oYXNPd25Qcm9wZXJ0eSgnWmFuZ2RhcicpICYmICh3aW5kb3cuWmFuZ2RhciA9IFphbmdkYXIpXG4gICAgaWYoIUhUTUxGb3JtRWxlbWVudC5wcm90b3R5cGUuemFuZ2Rhcikge1xuICAgICAgICBIVE1MRm9ybUVsZW1lbnQucHJvdG90eXBlLnphbmdkYXIgPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBaYW5nZGFyKHRoaXMsIG9wdGlvbnMpXG4gICAgICAgIH1cbiAgICB9XG59IGVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0gWmFuZ2RhclxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==